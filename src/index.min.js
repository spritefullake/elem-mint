var $E=function(e){return $E.mint(e)};$E.removeSection=function(e,t,r){var n=e.slice(t,r);return e=e.replace(n,"")},$E.findAttrs=function(e){var t=e.slice(e.indexOf("["),e.indexOf("]")+1).replace("[","").replace("]","").split("=");return t},$E.mint=function(e){e=e.replace(/\s+/g,""),e=e.split(",");for(var t=[],r=0,n=e.length;n>r;r++){var i,a,l,p,d,o=e[r],c="",s=[];o=o.replace(/\+/g,"[samelevelchildas=true],");for(var u=function(){var e=o.indexOf(":"),t=o.replace(":","!"),r=t.indexOf(":"),n=r-e>1?parseInt(o.slice(e+1,r)):1;o=o.replace(":","[nextstepsupalevel="+n+"]"),1==n&&(n=""),o=o.replace(n.toString()+":",",")};o.search(/:/)>=0;)u();if(o.indexOf(">")>=0){var f=o.replace(">",","),v=$E.mint(f);v=[].concat.apply([],v);var m=0;v.reduce(function(e,t,r,n){if(parseInt(e.getAttribute("nextstepsupalevel"))>0){for(var i=e.parentNode,a=0,l=parseInt(e.getAttribute("nextstepsupalevel"));l>a;a++)i=i.parentNode;e.removeAttribute("nextstepsupalevel"),i.appendChild(t),m++}return"true"==e.getAttribute("samelevelchildas")?(e.parentNode.appendChild(t),e.removeAttribute("samelevelchildas")):0==m&&e.appendChild(t),m=0,t});for(var h=0,x=v.length;x>h;h++)t.push(v[h])}else{for(;o.indexOf("[")>=0;)s.push($E.findAttrs(o)),o=$E.removeSection(o,o.indexOf("["),o.indexOf("]")+1);if(o.indexOf("#")>=0){l=o.slice(o.indexOf("#")+1).search(/([:.[])/);var g=o.split("#")[0].length;-1==l&&(l=o.length-1),l=g+l+1,a=o.slice(o.indexOf("#")+1,l),o=$E.removeSection(o,o.indexOf("#"),l)}else a="";i=o.split("."),p=i.shift();for(var E=0,$=i.length;$>E;E++)c+=i[E],c+=" ";s=[].concat.apply([],s),c=c.trim(),d=document.createElement(p),d.id=a,d.className=c;for(var O=0,A=s.length;A>O;O++)O%2==0&&d.setAttribute(s[O],s[O+1]);t.push(d)}}return t},$E.render=function(e,t){t=t||document.body,"string"==typeof t&&(t=document.querySelector(t));for(var r=$E.mint(e),n=document.createDocumentFragment(),i=0,a=r.length;a>i;i++)r.indexOf(r[i].parentNode)>-1||n.appendChild(r[i]);t.appendChild(n)},void 0!=module.exports?module.exports=$E:window.$E=$E;